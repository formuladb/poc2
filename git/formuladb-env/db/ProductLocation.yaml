_id: ProductLocation
props:
    _id:
        name: _id
        propType_: STRING
        required: true
    product_id:
        name: product_id
        propType_: STRING
        required: true
        defaultValue: DEFAULT-location
    location_code:
        name: location_code
        propType_: STRING
        required: true
        defaultValue: DEFAULT-location
    category:
        name: category
        propType_: STRING
        required: true
    received_stock__:
        name: received_stock__
        propType_: FORMULA
        formula: 'SUMIF(ReceiptItem.quantity, product_id == @[_id])'
    available_stock__:
        name: available_stock__
        propType_: FORMULA
        formula: received_stock__ - ordered_stock__
    ordered_stock__:
        name: ordered_stock__
        propType_: FORMULA
        formula: 'SUMIF(OrderItem.quantity, product_id == @[_id])'
    price:
        name: price
        propType_: NUMBER
    currency:
        propType_: REFERENCE_TO
        referencedEntityName: General_Currency
        referencedPropertyName: code
        name: currency__
    minimal_stock:
        name: minimal_stock
        propType_: NUMBER
        required: true
    moving_stock:
        name: moving_stock
        propType_: NUMBER
        required: true
    state:
        name: state
        propType_: STRING
        required: true
    _owner: { name: _owner, propType_: STRING, required: true }
    _role: { name: _role, propType_: STRING, required: true }
    _rev: { name: _rev, propType_: STRING, required: true }
validations:
    positiveStock:
        conditionExpr:
            type: BinaryExpression
            startIndex: 0
            endIndex: 22
            origExpr: available_stock__ >= 0
            operator: '>='
            left: {type: Identifier, startIndex: 0, endIndex: 17, origExpr: available_stock__, name: available_stock__}
            right: {type: NumberLiteral, startIndex: 21, endIndex: 22, origExpr: '0', value: 0, raw: '0'}
isEditable: true
